<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Notes Paper</title>
<style>
  body {
    margin: 0;
    background-color: black;
    color: white;
    font-family: Arial, sans-serif;
    min-height: 100vh;
    position: relative;
  }
  /* Buttons at bottom corners (Create Category / Create Note) */
  .btn {
    background-color: #333;
    color: white;
    padding: 10px 14px;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
    font-weight: bold;
    font-size: 14px;
    user-select: none;
  }
  .btn:hover {
    background-color: #555;
  }
  .btn-round {
    border-radius: 12px;
  }
  .btn-circle {
    border-radius: 9999px;
  }
  .bottom-left { position: absolute; bottom: 20px; left: 20px; z-index: 10;}
  .bottom-right { position: absolute; bottom: 20px; right: 20px; z-index: 10;}

  /* Paper-shaped style for categories, notes, edit button */
  .paper-btn {
    background: white;
    color: black;
    padding: 20px;
    border-radius: 6px;
    box-shadow:
      0 4px 6px rgba(0,0,0,0.2),
      inset 0 2px 5px rgba(255,255,255,0.9),
      inset 0 -5px 5px rgba(242,242,242,0.7);
    min-width: 150px;
    display: inline-block;
    text-align: center;
    margin: 5px;
    cursor: pointer;
    transition: transform 0.2s;
    background-image: linear-gradient(to bottom, white 97%, #f2f2f2 100%);
    user-select: none;
  }
  .paper-btn:hover {
    transform: scale(1.05);
  }

  /* Container for categories or notes */
  #app > div {
    padding: 20px;
  }

  /* Centered text for note view */
  .center {
    text-align: center;
    padding: 20px;
  }
  .center h1 {
    font-size: 2em;
    margin-bottom: 20px;
  }
  .center p {
    font-size: 1em;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<div id="app"></div>

<script>
  const app = document.getElementById('app');

  let categories = [];
  let notes = {}; // categoryName: [{id, title, text}]
  let view = "home"; // "home" | categoryName | "note"
  let selectedNote = null;
  let previousView = null;

  function render() {
    app.innerHTML = "";

    if (view === "home") {
      const container = document.createElement("div");
      categories.forEach(cat => {
        const div = document.createElement("div");
        div.className = "paper-btn";
        div.textContent = cat;
        div.onclick = () => { 
          previousView = "home";
          view = cat; 
          render(); 
        };
        container.appendChild(div);
      });
      app.appendChild(container);
    } 
    else if (categories.includes(view)) {
      const container = document.createElement("div");
      notes[view].forEach(note => {
        const div = document.createElement("div");
        div.className = "paper-btn";
        div.textContent = note.title;
        div.onclick = () => {
          previousView = view;
          selectedNote = note;
          view = "note";
          render();
        };
        container.appendChild(div);
      });
      app.appendChild(container);
    } 
    else if (view === "note" && selectedNote) {
      const div = document.createElement("div");
      div.className = "center";

      const title = document.createElement("h1");
      title.textContent = selectedNote.title;
      div.appendChild(title);

      const text = document.createElement("p");
      text.textContent = selectedNote.text;
      div.appendChild(text);

      const editBtn = document.createElement("button");
      editBtn.className = "paper-btn";
      editBtn.style.minWidth = "auto";
      editBtn.style.marginTop = "30px";
      editBtn.textContent = "Edit Note";
      editBtn.onclick = () => {
        const newTitle = prompt("Edit title:", selectedNote.title);
        if (newTitle === null) return; // Cancelled
        const newText = prompt("Edit text:", selectedNote.text);
        if (newText === null) return; // Cancelled
        selectedNote.title = newTitle.trim() || selectedNote.title;
        selectedNote.text = newText.trim();
        render();
      };
      div.appendChild(editBtn);

      app.appendChild(div);
    }

    // Create Category button
    let createCatBtn = document.querySelector(".bottom-left");
    if (!createCatBtn) {
      createCatBtn = document.createElement("button");
      createCatBtn.className = "btn btn-round bottom-left";
      createCatBtn.textContent = "+ Create Category";
      createCatBtn.onclick = () => {
        const name = prompt("Name your category");
        if (name) {
          const trimmed = name.trim();
          if (trimmed && !categories.includes(trimmed)) {
            categories.push(trimmed);
            notes[trimmed] = [];
            render();
          } else if (categories.includes(trimmed)) {
            alert("Category already exists!");
          }
        }
      };
      document.body.appendChild(createCatBtn);
    }

    // Create Note button
    let createNoteBtn = document.querySelector(".bottom-right");
    if (!createNoteBtn) {
      createNoteBtn = document.createElement("button");
      createNoteBtn.className = "btn btn-circle bottom-right";
      createNoteBtn.textContent = "+ Create Note";
      createNoteBtn.onclick = () => {
        if (categories.length === 0) {
          alert("No categories yet!");
          return;
        }
        const category = prompt("What category?\n" + categories.join(", "));
        if (category && categories.includes(category.trim())) {
          const title = prompt("Note title:");
          if (title && title.trim()) {
            const newNote = { id: Date.now(), title: title.trim(), text: "" };
            notes[category.trim()].push(newNote);
            render();
          }
        } else if (category) {
          alert("Category does not exist.");
        }
      };
      document.body.appendChild(createNoteBtn);
    }
  }

  // ESC key to go back
  document.addEventListener("keydown", e => {
    if (e.key === "Escape") {
      if (previousView) {
        view = previousView;
        if (view === "home") {
          previousView = null;
        } else {
          previousView = "home";
        }
        selectedNote = null;
        render();
      }
    }
  });

  render();
</script>

</body>
</html>
