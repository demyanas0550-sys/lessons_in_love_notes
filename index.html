<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lessons in Love notes</title>
<style>
body {
  font-family: sans-serif;
  background: #000; /* fully black */
  margin: 0;
  padding: 0;
  color: white;
}

#app {
  height: 100vh;
  display: flex;
  flex-direction: column;
}

#content {
  flex: 1;
  padding: 20px;
}

button {
  font-size: 14px;
  cursor: pointer;
  padding: 10px 16px;
  border: none;
  border-radius: 8px; /* rounded corners */
  background: black;
  color: white;
  transition: background 0.2s;
}

button:hover {
  background: #222;
}

#createCat {
  position: fixed;
  bottom: 20px;
  left: 20px;
}

#createNote {
  position: fixed;
  bottom: 20px;
  right: 20px;
}

.paper-btn {
  display: flex;
  justify-content: center;
  align-items: center;

  width: 108px;  /* fixed size */
  height: 144px;
  padding: 10px;

  text-align: center;
  margin: 8px;
  cursor: pointer;
  user-select: none;
  border: none;

  background: linear-gradient(180deg, #ffffff 96%, #f2f2f2 100%);
  color: #111;
  border-radius: 6px;
  box-shadow:
    0 6px 18px rgba(0,0,0,0.25),
    inset 0 3px 6px rgba(255,255,255,0.9),
    inset 0 -6px 8px rgba(230,230,230,0.6);

  outline: 1px solid rgba(0,0,0,0.04);

  font-weight: 700;
  font-size: 14px;
  line-height: 1.2;
  
  white-space: normal;
  overflow-wrap: break-word;
  word-break: break-word;
  overflow: hidden;

  transition: transform 0.14s ease, box-shadow 0.14s ease;
}

.grid {
  display: flex;
  flex-wrap: wrap;
}

.note-view {
  background: white;
  padding: 20px;
  border-radius: 6px;
  color: black;
}
</style>
</head>
<body>

<div id="app">
  <div id="content"></div>
  <button id="createCat">+ Create Category</button>
  <button id="createNote">+ Create Note</button>
</div>

<script>
let categories = [];
let notes = {};
let view = "home";
let previousView = null;
let selectedNote = null;

function saveData() {
  localStorage.setItem("notesAppCategories", JSON.stringify(categories));
  localStorage.setItem("notesAppNotes", JSON.stringify(notes));
}

function loadData() {
  const savedCategories = localStorage.getItem("notesAppCategories");
  const savedNotes = localStorage.getItem("notesAppNotes");
  if (savedCategories) categories = JSON.parse(savedCategories);
  if (savedNotes) notes = JSON.parse(savedNotes);
}

loadData();

const content = document.getElementById("content");
const createCatBtn = document.getElementById("createCat");
const createNoteBtn = document.getElementById("createNote");

createCatBtn.onclick = () => {
  const name = prompt("Name your category");
  if (name) {
    const trimmed = name.trim();
    if (!trimmed) return;

    if (categories.includes(trimmed)) {
      if (confirm(`Delete category "${trimmed}" and all its notes?`)) {
        categories = categories.filter(c => c !== trimmed);
        delete notes[trimmed];
        if (view === trimmed || previousView === trimmed) {
          view = "home";
          previousView = null;
          selectedNote = null;
        }
        saveData();
        render();
        return;
      } else return;
    }

    categories.push(trimmed);
    notes[trimmed] = [];
    saveData();
    render();
  }
};

createNoteBtn.onclick = () => {
  if (categories.length === 0) {
    alert("No categories yet!");
    return;
  }
  const category = prompt("What category?\n" + categories.join(", "));
  if (category && categories.includes(category.trim())) {
    const title = prompt("Note title:");
    if (title && title.trim()) {
      const newNote = { id: Date.now(), title: title.trim(), text: "" };
      notes[category.trim()].push(newNote);
      saveData();
      render();
    }
  } else if (category) {
    alert("Category does not exist.");
  }
};

document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    if (previousView) {
      view = previousView;
      previousView = null;
      selectedNote = null;
    } else {
      view = "home";
      selectedNote = null;
    }
    render();
  }
});

function render() {
  content.innerHTML = "";

  if (view === "home") {
    const grid = document.createElement("div");
    grid.className = "grid";
    categories.forEach(cat => {
      const btn = document.createElement("div");
      btn.className = "paper-btn";
      btn.textContent = cat;
      btn.onclick = () => {
        previousView = "home";
        view = cat;
        render();
      };
      grid.appendChild(btn);
    });
    content.appendChild(grid);
  } 
  else if (categories.includes(view)) {
    const grid = document.createElement("div");
    grid.className = "grid";
    notes[view].forEach(note => {
      const btn = document.createElement("div");
      btn.className = "paper-btn";
      btn.textContent = note.title;
      btn.onclick = () => {
        previousView = view;
        view = "note";
        selectedNote = note;
        render();
      };
      grid.appendChild(btn);
    });
    content.appendChild(grid);
  } 
  else if (view === "note" && selectedNote) {
    const noteDiv = document.createElement("div");
    noteDiv.className = "note-view";
    const title = document.createElement("h2");
    title.textContent = selectedNote.title;
    const text = document.createElement("p");
    text.textContent = selectedNote.text;

    const editBtn = document.createElement("button");
    editBtn.textContent = "Edit";
    editBtn.onclick = () => {
      const newTitle = prompt("Edit title:", selectedNote.title);
      if (newTitle === null) return;
      const newText = prompt("Edit text:", selectedNote.text);
      if (newText === null) return;
      selectedNote.title = newTitle.trim() || selectedNote.title;
      selectedNote.text = newText.trim();
      saveData();
      render();
    };

    noteDiv.appendChild(title);
    noteDiv.appendChild(text);
    noteDiv.appendChild(editBtn);
    content.appendChild(noteDiv);
  }
}

render();
</script>

</body>
</html>
