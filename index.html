<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Notes App</title>
<style>
body {
  font-family: sans-serif;
  background: #f4f4f4;
  margin: 0;
  padding: 0;
}

#app {
  padding: 20px;
}

.header {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

button {
  padding: 8px 12px;
  font-size: 14px;
  cursor: pointer;
}

.paper-btn {
  display: flex;
  justify-content: center;
  align-items: center;

  width: 108px;  /* fixed width */
  height: 144px; /* fixed height */
  padding: 10px;

  text-align: center;
  margin: 8px;
  cursor: pointer;
  user-select: none;
  border: none;

  background: linear-gradient(180deg, #ffffff 96%, #f2f2f2 100%);
  color: #111;
  border-radius: 6px;
  box-shadow:
    0 6px 18px rgba(0,0,0,0.25),
    inset 0 3px 6px rgba(255,255,255,0.9),
    inset 0 -6px 8px rgba(230,230,230,0.6);

  outline: 1px solid rgba(0,0,0,0.04);

  font-weight: 700;
  font-size: 14px;
  line-height: 1.2;
  
  white-space: normal;       /* allow wrapping */
  overflow-wrap: break-word; /* break long words */
  word-break: break-word;
  overflow: hidden;          /* hide overflow if any */

  transition: transform 0.14s ease, box-shadow 0.14s ease;
}

.grid {
  display: flex;
  flex-wrap: wrap;
}

.note-view {
  background: white;
  padding: 20px;
  border-radius: 6px;
}

</style>
</head>
<body>

<div id="app">
  <div class="header">
    <button id="createCat">Create Category</button>
    <button id="createNote">Create Note</button>
    <button id="backBtn" style="display:none;">Back</button>
  </div>
  <div id="content"></div>
</div>

<script>
let categories = [];
let notes = {};
let view = "home";
let previousView = null;
let selectedNote = null;

// --- LocalStorage functions ---
function saveData() {
  localStorage.setItem("notesAppCategories", JSON.stringify(categories));
  localStorage.setItem("notesAppNotes", JSON.stringify(notes));
}

function loadData() {
  const savedCategories = localStorage.getItem("notesAppCategories");
  const savedNotes = localStorage.getItem("notesAppNotes");

  if (savedCategories) {
    categories = JSON.parse(savedCategories);
  }
  if (savedNotes) {
    notes = JSON.parse(savedNotes);
  }
}

// --- Load stored data on start ---
loadData();

const content = document.getElementById("content");
const createCatBtn = document.getElementById("createCat");
const createNoteBtn = document.getElementById("createNote");
const backBtn = document.getElementById("backBtn");

createCatBtn.onclick = () => {
  const name = prompt("Name your category");
  if (name) {
    const trimmed = name.trim();
    if (!trimmed) return;

    if (categories.includes(trimmed)) {
      if (confirm(`Delete category "${trimmed}" and all its notes?`)) {
        categories = categories.filter(c => c !== trimmed);
        delete notes[trimmed];
        if (view === trimmed || previousView === trimmed) {
          view = "home";
          previousView = null;
          selectedNote = null;
        }
        saveData();
        render();
        return;
      } else {
        return;
      }
    }

    categories.push(trimmed);
    notes[trimmed] = [];
    saveData();
    render();
  }
};

createNoteBtn.onclick = () => {
  if (categories.length === 0) {
    alert("No categories yet!");
    return;
  }
  const category = prompt("What category?\n" + categories.join(", "));
  if (category && categories.includes(category.trim())) {
    const title = prompt("Note title:");
    if (title && title.trim()) {
      const newNote = { id: Date.now(), title: title.trim(), text: "" };
      notes[category.trim()].push(newNote);
      saveData();
      render();
    }
  } else if (category) {
    alert("Category does not exist.");
  }
};

backBtn.onclick = () => {
  if (previousView) {
    view = previousView;
    previousView = null;
    selectedNote = null;
  } else {
    view = "home";
    selectedNote = null;
  }
  render();
};

function render() {
  content.innerHTML = "";
  backBtn.style.display = view === "home" ? "none" : "inline-block";

  if (view === "home") {
    const grid = document.createElement("div");
    grid.className = "grid";
    categories.forEach(cat => {
      const btn = document.createElement("div");
      btn.className = "paper-btn";
      btn.textContent = cat;
      btn.onclick = () => {
        previousView = "home";
        view = cat;
        render();
      };
      grid.appendChild(btn);
    });
    content.appendChild(grid);
  } 
  else if (categories.includes(view)) {
    const grid = document.createElement("div");
    grid.className = "grid";
    notes[view].forEach(note => {
      const btn = document.createElement("div");
      btn.className = "paper-btn";
      btn.textContent = note.title;
      btn.onclick = () => {
        previousView = view;
        view = "note";
        selectedNote = note;
        render();
      };
      grid.appendChild(btn);
    });
    content.appendChild(grid);
  } 
  else if (view === "note" && selectedNote) {
    const noteDiv = document.createElement("div");
    noteDiv.className = "note-view";
    const title = document.createElement("h2");
    title.textContent = selectedNote.title;
    const text = document.createElement("p");
    text.textContent = selectedNote.text;

    const editBtn = document.createElement("button");
    editBtn.textContent = "Edit";
    editBtn.onclick = () => {
      const newTitle = prompt("Edit title:", selectedNote.title);
      if (newTitle === null) return;
      const newText = prompt("Edit text:", selectedNote.text);
      if (newText === null) return;
      selectedNote.title = newTitle.trim() || selectedNote.title;
      selectedNote.text = newText.trim();
      saveData();
      render();
    };

    noteDiv.appendChild(title);
    noteDiv.appendChild(text);
    noteDiv.appendChild(editBtn);
    content.appendChild(noteDiv);
  }
}

render();
</script>

</body>
</html>
